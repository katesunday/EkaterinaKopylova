<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Modal default</title>
    <link href="https://fonts.googleapis.com/css?family=Exo+2" rel="stylesheet">
    <!-- <link rel="stylesheet" href="styles.css"> -->
  <style>
    body {
  margin: 0;
  background-color:#556;
  background-image: linear-gradient(30deg, #445 12%, transparent 12.5%, transparent 87%, #445 87.5%, #445),
  linear-gradient(150deg, #445 12%, transparent 12.5%, transparent 87%, #445 87.5%, #445),
  linear-gradient(30deg, #445 12%, transparent 12.5%, transparent 87%, #445 87.5%, #445),
  linear-gradient(150deg, #445 12%, transparent 12.5%, transparent 87%, #445 87.5%, #445),
  linear-gradient(60deg, #99a 25%, transparent 25.5%, transparent 75%, #99a 75%, #99a), 
  linear-gradient(60deg, #99a 25%, transparent 25.5%, transparent 75%, #99a 75%, #99a);
  background-size:80px 140px;
  background-position: 0 0, 0 0, 40px 70px, 40px 70px, 0 0, 40px 70px;
  font-family: "Exo 2", sans-serif;
  box-sizing: border-box;
}

*, *:before, *:after {
  box-sizing: inherit;
}

.container {
  margin: 20px;
  padding: 20px;
  min-height: 600px;
  font-size: 16px;
  background-color: #fff;
}

.container > p:last-of-type {
  text-align: center;
  margin-top: 50px;
}

.container .btn {
  text-align: center;
  margin-top: 20px;
}

.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 50;
  background: rgba(0, 0, 0, 0.6);
}

.modal-open {
  display: inline-block;
  color: #fff;
  border: 1px #007bff solid;
  border-radius: 5px;
  padding: 8px 12px;
  font-size: 16px;
  font-family: 'Exo 2', sans-serif;
  background-color: #007bff;
  text-decoration: none;
}

.modal-open:hover {
  text-decoration: none;
  background-color: #0069d9;
  border-color: #0062cc;
}

.modal-open:active {
  text-decoration: none;
  background-color: #0062cc;
  border-color: #005cbf;
}

.modal {
  display: block;
  width: 600px;
  max-width: 100%;
  height: 400px;
  max-height: 100%;
  position: fixed;
  z-index: 100;
  left: 50%;
  top: 50%;
  border-radius: 10px;
  transform: translate(-50%, -50%);
  background: white;
  box-shadow: 0 0 60px 10px rgba(0, 0, 0, 0.9);
}

.modal_closed {
  display: none;
}

.modal__header {
  border-bottom: 1px gray solid;
  padding: 10px 15px;
  margin-bottom: 15px;
}

.modal__close {
  position: absolute;
  top: 15px;
  right: 15px;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAEFCu8CAAAABGdBTUEAALGPC/xhBQAAAqpJREFUSA2tljtyFEEMhsdgHJpb2NyAxwkgcQHGHGE3Bs4B8RICV6G4ARSERH4QGaog4vF/qv7HWu3MzrqMqjR69C9puls9PV13QU9Rr13Y3Vfpf7GPxLdRROGw0hs43vHYFuM9wYAMOcbYaQ47u7fJgRMGFMkwIgyHyIDesNMgAD3dkvZDvGWPlSVUG4wxBu43h0HIGT4UO7Hv2EeoB1wCQPhYzi/i12JHSA26acWpLV96IMtDGQZU+TEDrT9qAb8lD8RnzXbwC9mL5vsjGbSvpwGnzWfB+5s8F7C/cLLSDrS8y0Ci+gbguutiBzxLYCoQkMm4D0NOD47JwVUl0Vz8U5wD38veFa8ldptDw9xpfhZvkj4JkStlnT1eoXxmMrjqHKUlYlMBsclsdg5gZWkKmgP/Q3EQi2Fgc/WNe2yH5IOKowscWDslxXV0lXF7DNiwzMEOpLLHkTHX7ECv3XKvBIH5Ll7KlOfEmIm3yAWeMEDf2Ylt+iYlv/Zz2cbR39FKdmBDeU4O5jMB7jMA0yspDp6SjunlJsE3enRROAGchFyVkzIruEmTT91cTLJ61GpyMGApfinioGwy3VxwSCcHudbS/yhUi5NzhXbl4QbJ4EVB0T65nYzF59ZyiFvMGFqNGkE0a25yg/KHuUFDkJxjB9dCAdAjHwbno0YcDP4s7KySt/dfh9RJ4gWGVsF54wgP3VMGWDKbenfl6nxYwBg/JuNjw8UwBsA/tEdyr9DU7MgVn8V9Kflj7OL8kY0tJ8nH9g9//mg7HzX2xEFzPT1g6V+pBglRZzE2+3y9ON8sJ0LnD8eXHCAus4X4QMyFt26PGAMDliPhi5A85OwvROlLtCOLdfZbXVWSi5wb0WOh+Nm7bFFiiL0S8btDc/HL80Z83hgdH2NgJukfa8ehuEonW4wAAAAASUVORK5CYII=');
  overflow: hidden;
  text-indent: -999em;
  text-decoration: none;
}

.modal__close:hover {
  background-color: #dc3545;
  text-decoration: none;
}

.modal__content {
  padding: 10px 15px;
  min-height: 200px;
}

.form-field {
  padding: 0 0 10px;
}
/* 
.form-field label {} */

.form-field input {
  border: 1px gray solid;
  border-radius: 5px;
  padding: 8px 12px;
  margin: 0 10px;
  font-size: 14px;
  font-family: "Exo 2", sans-serif;
}

.form-field .input__default {
  width: 380px;
}

.form-field .input__date-birth {
  width: 100px;
  text-align: center;
}

.modal__footer {
  border-top: 1px gray solid;
  padding: 15px;
  margin-top: 15px;
  text-align: right;
}

.modal__footer button {
  border: 1px gray solid;
  border-radius: 5px;
  padding: 8px 12px;
  margin: 0 10px;
  font-size: 14px;
  font-family: "Exo 2", sans-serif;
}

.modal__footer .modal__cancel {
  background-color: #dc3545;
  border-color: #dc3545;
  color: #fff;
}

.modal__footer .modal__cancel:hover {
  background-color: #c82333;
  border-color: #bd2130;
}

.modal__footer .modal__cancel:active {
  background-color: #bd2130;
  border-color: #b21f2d;
}

.modal__footer .modal__save {
  background-color: #28a745;
  border-color: #28a745;
  color: #fff;
}

.modal__footer .modal__save:hover {
  background-color: #218838;
  border-color: #1e7e34;
}

.modal__footer .modal__save:active {
  background-color: #1e7e34;
  border-color: #1c7430;
}

.modal__footer .modal__save:disabled {
  opacity: 0.7;
  background-color: #28a745;
  border-color: #28a745;
  color: #fff;
  cursor: not-allowed;
}

.hide {
  display: none;
}
.modal-data{
    display: none;
}
.clear__data{
    display: inline-block;
    color: #fff;
    border: 1px #007bff solid;
    border-radius: 5px;
    padding: 4px 8px;
    font-size: 16px;
    font-family: 'Exo 2', sans-serif;
    background-color: #007bff;
    text-decoration: none;

}

  </style>
</head>

<body>

    <div class="container">
        <h1>Создание простейшего модального окошка!</h1>

        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam fuga sunt voluptas, ullam, sed consequuntur ab illo veniam ad totam alias voluptatibus sequi officiis, unde autem reiciendis magnam labore voluptatum?</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam fuga sunt voluptas, ullam, sed consequuntur ab illo veniam ad totam alias voluptatibus sequi officiis, unde autem reiciendis magnam labore voluptatum?</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam fuga sunt voluptas, ullam, sed consequuntur ab illo veniam ad totam alias voluptatibus sequi officiis, unde autem reiciendis magnam labore voluptatum?</p>
        <p class="btn"><a href="#" id="modal-open" class="modal-open" title="Покажите мне модальное окошко">Открыть окно</a></p>
        <div id="modal-data" class="modal-data"> 
            <p class="text"></p>
            <button id="clear-data" class="clear__data" title="Удалить данные">Удалить данные</button>
          </div>
    </div>

    <div class="modal-overlay modal_closed" id="modal-overlay"></div>
    <div class="modal modal_closed" id="modal">
        <header class="modal__header">
            <a href="#" class="modal__close" id="modal-close" title="Закрыть модальное окно">Закрыть</a>
            <h2>Введите данные</h2>
        </header>

        <main class="modal__content">
            <div class="form-field">
                <label for="name">Ваше имя:</label>
                <input class="input__default" type="text" id="name" name="name">
            </div>
            <div class="form-field">
                <label>Ваш день рождения:</label>
                <input type="text" class="input__date-birth" id="birth-day" name="name" placeholder="День"> -
                <input type="text" class="input__date-birth" id="birth-month" name="name" placeholder="Месяц"> -
                <input type="text" class="input__date-birth" id="birth-year" name="name" placeholder="Год">
            </div>
        </main>

        <footer class="modal__footer">
            <button id="modal-cancel" class="modal__cancel" title="Отмена">Отмена</button>
            <button id="modal-save" class="modal__save" title="Сохранить">Сохранить данные</button>
        </footer>
    </div>
    

    <script>

        /* ------- begin view -------- */
          function ModalView() {
            let myModal = null;
            let myModalOverlay = null;
            let inputs = null;
            let btnSave = null;
            let divData = null;
            let btnDel = null;
            let text = null;
           
        
            this.init = function(container,contOverlay) {
                myModal = container;
                myModalOverlay = contOverlay; 
                inputs = myModal.querySelectorAll('input');  
                btnSave = myModal.querySelector('.modal__save') ;
                btnSave.disabled = true;
                divData = myModal.parentNode.querySelector('.modal-data');
                btnDel = myModal.parentNode.querySelector('.clear__data');
                text =  myModal.parentNode.querySelector('.text');
            }
        
            this.show = function () {
                myModal.classList.remove('modal_closed');
                myModalOverlay.classList.remove('modal_closed');
            }
        
            this.hide = function () {
                myModal.classList.add('modal_closed');
                myModalOverlay.classList.add('modal_closed');
                inputs.forEach(element => {
                    element.value = '';
                });
            }

            this.disableBtn = function(){
                btnSave.disabled = false;
            }

        
            this.printViewData = function (savedUser) { // вывести данные из хранилища в div.modal-data
                  divData.style.display = 'block';
                  text.textContent = `Привет, ${savedUser.name}!`;
            }
        
            this.clearViewData = function () { // очистить или выдать дефолтное сообщение только для div.modal-data
                 btnDel.style.display = 'none';
                 divData.textContent = 'Данные удалены.'
            }
        
          };
        /* -------- end view --------- */
        
        /* ------- begin model ------- */
          function ModalModel () {
            let myModalContainer = null;
            let myModalView = null;
            let userData = {};
        
            this.init = function(view,container) { // тут нужно объяснить
                myModalContainer = container;
                myModalView = view;
            }
        
            this.openModal = function() {
                myModalView.show(); 
            }
        
            this.closeModal = function() {
                myModalView.hide();
            }

            this.checkData = function(name = false,day = false,month = false,year = false){// по дефолту все фолс
                let checkName = Boolean(name && isNaN(name));
                let checkDay = Boolean(day && day > 0 && day <= 31);
                let checkMonth = Boolean(month && month > 0 && month <=12);
                let checkYear = Boolean(year>1900);
                let check = Boolean(checkName && checkDay && checkMonth && checkYear); // все должно быть тру
                if(check === true){ // если тру то включаем кнопку
                    this.disableBtn();
                }
            }
            
             this.disableBtn =  function(){
                 myModalView.disableBtn();
             }

            
        
            this.saveModalData = function(name,day,month,year) { //получить данные из модалки и сохранить
                userData.name = name;
                userData.day = day;
                userData.month = month;
                userData.year = year;
                this.storeData();
                myModalView.hide();
            }
        
            this.storeData = function() { // сохранить данные в localStorage, а если не доступно, то в cookies
                window.localStorage.setItem("user", JSON.stringify(userData));
                if(window.localStorage.getItem("user") != null){
                    this.getData();   
                }
                else{
                    for (const [key, value] of Object.entries(userData)) {
                 this.setCookie(key,value,{secure: true, 'max-age': 3600});
                }
                }
            }
            this.setCookie = function(name, value, options = { path: '/' }) {

             if (options.expires instanceof Date) {
                 options.expires = options.expires.toUTCString();
             }
             if (value instanceof Object) {
                value = JSON.stringify(value);
              }

             let updatedCookie = name + "=" + value;

             for (let optionKey in options) {
                updatedCookie += "; " + optionKey;
                let optionValue = options[optionKey];
             if (options[optionKey] !== true) {
                updatedCookie += "=" + options[optionKey];
             }
             }
             document.cookie = updatedCookie;
             }
        
            this.getData = function() { //достать данные из хранилища
                var savedUser = JSON.parse(window.localStorage.getItem("user"));
                myModalView.printViewData(savedUser);    
            }
        
            this.updateData = function() {
                var savedUser = JSON.parse(window.localStorage.getItem("user"));
                if(savedUser){
                    myModalView.printViewData(savedUser); 
                }
            }
        
            this.clearData = function() { //очистить данные в хранилище
                if(window.localStorage.getItem("user") != null){
                    window.localStorage.removeItem("user");
                    this.clearForm();
                }
                
            }
        
            this.clearForm = function() { //очистить данные в форме
                myModalView.clearViewData();
            };
        
        }
        /* -------- end model -------- */
        
        /* ----- begin controller ---- */
          function ModalController () {
            let myModalContainer = null;
            let myModalModel = null;
            let inputs = null;
        
            this.init = function(model,container) { // получаем кнопки и вешаем обработчики
                myModalContainer = container;
                myModalModel = model;
                this.openBtn =  myModalContainer.parentNode.querySelector(".modal-open");// открыть модалку ??????????
                this.modalClose = myModalContainer.querySelector('.modal__close'); // закрыть модалку
                this.modalCancel = myModalContainer.querySelector('.modal__cancel'); // закрыть модалку
                this.modalSave = myModalContainer.querySelector('.modal__save'); // сохранить данные
                this.inpName = myModalContainer.querySelector('.input__default'); // ввод имени
                this.DODinp = myModalContainer.querySelectorAll('.input__date-birth'); // др
                inputs = myModalContainer.querySelectorAll('input');
                this.btnDelData = myModalContainer.parentNode.querySelector('.clear__data');
                this.openBtn.addEventListener('click', this.openModal);
                this.modalClose.addEventListener('click', this.hideModal);
                this.modalCancel.addEventListener('click', this.hideModal);
                this.modalSave.addEventListener('click',this.saveModal);
                this.btnDelData.addEventListener('click',this.clearData);
                myModalContainer.addEventListener('input',this.checkInputs);
                myModalModel.updateData(); //проверка на наличие юзера в local storage


            }
            this.checkInputs = function(e){ // проверка ввода данных
                 if (e.target.tagName === 'INPUT'){
                 e.preventDefault();
                 let name = appModalController.inpName.value;
                 let day = appModalController.DODinp[0].value;
                 let month = appModalController.DODinp[1].value;
                 let year = appModalController.DODinp[2].value;
                 myModalModel.checkData(name,day,month,year); // доп функция проверки
                 }
                 };

            this.openModal = function (e) {
                e.preventDefault(); 
                myModalModel.openModal(); 
            }
        
            this.hideModal = function (e) {
                e.preventDefault(); 
                myModalModel.closeModal();
            }
        
            this.saveModal = function () {
                 let name = appModalController.inpName.value;
                 let day = appModalController.DODinp[0].value;
                 let month = appModalController.DODinp[1].value;
                 let year = appModalController.DODinp[2].value;
                myModalModel.saveModalData(name,day,month,year);
                myModalModel.closeModal();
            }
        
            this.clearData = function (e) {
                e.preventDefault();
                myModalModel.clearData();
            }
          };
        /* ------ end controller ----- */
        
        // глобальная инициализация
          const appModalView = new ModalView();
          const appModalModel = new ModalModel();
          const appModalController = new ModalController();
          const container = document.getElementById('modal');
          const contOverlay = document.getElementById('modal-overlay');
        //вызвать init-методы...
          appModalView.init(container,contOverlay);
          appModalModel.init(appModalView,container);
          appModalController.init(appModalModel,container);
          
        

        </script>
        
</body>
</html>